# 小智 ESP32 管理端网站规划（基于 hooks 推导）

## 概述
- 目标：为设备、智能体、模型与OTA等管理场景提供统一的管理后台。
- 依据：从 `src/hooks` 中已有能力反推页面与功能，并形成用户故事与原型草图。

## 页面清单
- 账户与认证
  - 登录、注册、找回密码（验证码/短信）
  - 修改密码、个人信息
- 概览与主页
  - 我的智能体概览（数量、设备数、最近会话）
- 智能体管理
  - 我的智能体列表（增/删/刷新）
  - 智能体详情
    - 会话/聊天记录
    - 设备（从属页：设备列表、搜索/分页、绑定/解绑/批量、手动添加、更新）
    - 声纹管理
    - MCP 工具
    - 音频播放/下载
- 设备工具
  - 设备注册/激活联调（设备侧接口联调入口）
- OTA 固件管理
  - 固件列表（搜索/分页/删除/下载）
  - 新增/编辑固件（上传/进度/校验）
- 模型管理
  - 模型列表（增删改、批量删、启用/禁用、默认）
  - 供应器（Provider）管理（分页、增改删、插件名称）
- 音色（Timbre）管理
  - 音色列表（按 TTS 模型分页、增改删）
- 字典管理
  - 字典类型列表、字典数据列表
- 参数管理
  - 参数列表（搜索/分页/选择、增改、批量删除）
- 配置中心
  - 服务端基础配置、智能体模型能力查询
- 管理员视图
  - 智能体（全局）列表（管理员）

## 功能清单（与 hooks 对应）
- 认证与安全：验证码、登录/注册/找回、修改密码、公共配置
- 智能体：列表/创建/删除、模板、设备维度更新、会话/聊天记录、声纹管理、MCP 工具、音频下载/播放、上传文件
- 设备：按智能体查询、绑定/解绑/批量解绑、手动添加、更新信息、注册/激活/OTA 版本检查
- OTA：列表、删除、下载链接、上传/编辑（进度与校验）
- 模型：列表、增改删、批量删除、启用/禁用、设默认、配置查看、供应器分页与增改删、插件名列表、模型名/LLM 代码列表
- 音色：列表、增改、批量删除
- 字典：类型与数据增改删、固件类型字典友好名
- 参数：列表、增改、批量删除
- 配置中心：服务端基础配置、Agent 模型能力
- 管理员：全局智能体列表

## 用户故事（摘选）
- 访客：
  - 作为访客，我能通过验证码/短信完成登录或注册。
  - 作为访客，我能找回密码以恢复访问。
- 用户：
  - 我能创建/删除智能体，查看设备数量与最近会话。
  - 我能在详情页查看会话/聊天记录，播放/下载历史音频，并管理声纹与 MCP 工具。
  - 我能对某智能体的设备进行搜索/分页、绑定/解绑/批量解绑、手动添加与更新。
  - 我能在 OTA 固件库中上传/编辑/删除/下载固件。
  - 我能管理模型（启用/禁用、默认、配置）与供应器，并查询模型名/LLM 名称。
  - 我能管理音色、字典（类型/数据）、参数，并修改密码与查看个人信息。
- 管理员：
  - 我能查看全局智能体列表用于审计/运维。

## 信息架构（菜单草案）
- 概览
- 智能体
  - 我的智能体
  - 智能体详情（子页/Tab）：会话｜设备（从属页）｜声纹｜MCP 工具｜音频
- 设备工具
  - 设备注册/激活联调
- OTA 固件
  - 固件列表
- 模型
  - 模型列表
  - 供应器管理
- 音色管理
- 字典
  - 字典类型
  - 字典数据
- 参数管理
- 配置中心
- 管理员
  - 智能体列表（管理员）
- 账号
  - 个人信息
  - 修改密码
  - 退出登录

---

## 页面展示与 ASCII 原型

### 登录
- 要点：账号、密码、图形验证码；支持跳转注册/找回；登录后按 `useAuthRedirect` 跳转。

```
+------------------------------------------------------+
| LOGO           小智管理平台                          |
|------------------------------------------------------|
|  账号: [______________________]                      |
|  密码: [______________________]  [显示]              |
|  验证码: [______] [图片验证码]  [刷新]               |
|                                                      |
| [ 登录 ]     [ 去注册 ]     [ 忘记密码 ]             |
+------------------------------------------------------+
```

### 注册
- 要点：手机号/邮箱、密码、图形/短信验证码；受 `usePublicConfig` 控制。

```
+----------------------------------------------+
| 注册                                          |
|----------------------------------------------|
| 手机/邮箱: [______________________________]   |
| 密    码: [______________________________]   |
| 确认密码: [______________________________]   |
| 图形验证码: [____] [图片] [刷新]             |
| 短信验证码: [____] [获取短信]                |
| [ 注册 ]             [ 返回登录 ]             |
+----------------------------------------------+
```

### 找回密码
- 要点：账号、验证码、新密码；对应 `useUserRetrievePassword...`。

```
+----------------------------------------------+
| 找回密码                                      |
|----------------------------------------------|
| 账号: [______________________________]        |
| 图形验证码: [____] [图片] [刷新]             |
| 短信验证码: [____] [获取短信]                |
| 新密码: [______________________________]      |
| [ 提交 ]             [ 返回登录 ]             |
+----------------------------------------------+
```

### 个人信息 / 修改密码
- 要点：`useUserInfo` 展示资料；`useChangePassword` 修改密码。

```
+----------------------------------------------------------------+
| 个人信息                                                        |
|----------------------------------------------------------------|
| 昵称: 张三    邮箱: xx@xx.com   手机: 138****                   |
| 角色: 普通用户   上次登录: 2025-09-13 20:12                     |
|                                                                |
| [ 编辑资料 ]                                                    |
|                                                                |
| 修改密码                                                       |
| 旧密码: [____________]  新密码: [____________]                 |
| 确认:   [____________]  [ 提交修改 ]                            |
+----------------------------------------------------------------+
```

### 概览（首页）
- 要点：智能体数、设备数、最近会话入口；与 `useAgentManagement` 协同。含侧边栏导航。

```
+----------------------+--------------------------------------------------------------+
| 导航                                                     | 概览                      |
| - 概览 (当前)                                           |----------------------------|
| - 智能体                                                | [卡片] 智能体: 4           |
|   · 我的智能体                                          | [卡片] 设备: 23            |
| - 设备工具                                              | [卡片] 固件: 12            |
|   · 注册/激活联调                                      | [卡片] 模型: 8             |
| - OTA 固件                                              |----------------------------|
| - 模型                                                   | 最近会话                   |
| - 音色管理                                              |  - 智能体A  昨日  [进入]   |
| - 字典                                                   |  - 智能体B  2小时前 [进入] |
| - 参数管理                                              |----------------------------|
| - 配置中心                                              | 快捷: [创建智能体][上传固件]|
| - 管理员                                                |       [新增模型][设备联调] |
| - 账号                                                  |                            |
+----------------------+--------------------------------------------------------------+
```

### 我的智能体列表
- 要点：列表、创建、删除、刷新；骨架屏数量与本地存储一致。含侧边栏导航。

```
+----------------------+--------------------------------------------------------------+
| 导航                                                     | 我的智能体                 |
| - 概览                                                   |----------------------------|
| - 智能体 (当前)                                         | [ 创建智能体 ]  [ 刷新 ]   |
|   · 我的智能体 (当前)                                   |----------------------------|
| - 设备工具                                              | #  名称   设备数  操作     |
| - OTA 固件                                              | 1 小智-A  6     [详情][删] |
| - 模型                                                   | 2 小智-B  3     [详情][删] |
| - 音色管理                                              | ...                        |
| - 字典                                                   |                            |
| - 参数管理                                              |                            |
| - 配置中心                                              |                            |
| - 管理员                                                |                            |
| - 账号                                                  |                            |
+----------------------+--------------------------------------------------------------+
```

### 智能体详情（Tab：会话 / 设备 / 声纹 / MCP / 音频）
- 对应 `agentHooks`：会话、聊天记录、声纹增改删、MCP 工具、音频播放/下载；设备子页从属于智能体。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 智能体详情  小智-A             |
| - 概览                                                   |----------------------------------------------------------------|
| - 智能体 (当前)                                         | [ 会话 ] [ 设备 ] [ 声纹 ] [ MCP ] [ 音频 ]                     |
|   · 我的智能体                                          |----------------------------------------------------------------|
| - 设备工具                                              | (会话) 会话列表(分页) [进入会话] [查看聊天记录]                 |
| - OTA 固件                                              |----------------------------------------------------------------|
| - 模型                                                   | (设备 从属页) 搜索/分页/绑定/解绑/批量/手动添加/更新           |
| - 音色管理                                              |  - [ 绑定设备 ] [ 手动添加 ] [ 批量解绑 ]                       |
| - 字典                                                   |  - 列表（设备ID/模型/MAC/状态/操作）                            |
| - 参数管理                                              |----------------------------------------------------------------|
| - 配置中心                                              | (声纹) 列表 [新建][编辑][删除]                                  |
| - 管理员                                                | (MCP) 工具列表 接入地址: https://...                            |
| - 账号                                                  | (音频) 历史音频 [播放][下载]                                    |
+----------------------+------------------------------------------------------------------+
```

### 智能体详情 · 设备（从属页）
- 对应 `useDeviceManagement`：搜索、分页、选择、绑定/解绑/批量、手动添加、更新。含侧边栏导航。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 设备（小智-A）                  |
| - 概览                                                   |----------------------------------------------------------------|
| - 智能体 (当前)                                         | 智能体: 小智-A   关键字:[___] [搜] 每页:[10▼] 页码: 1/5       |
|   · 我的智能体                                          | [ 绑定设备 ] [ 手动添加 ] [ 批量解绑 ]                          |
| - 设备工具                                              |----------------------------------------------------------------|
| - OTA 固件                                              | []全选 | # | 设备ID  | 模型     | MAC            | 状态 | 操作 |
| - 模型                                                   | [ ]    | 1 | dev-001 | esp32-s3 | AA:BB:..       | 在线 |[更][解]|
| - 音色管理                                              | [ ]    | 2 | dev-002 | esp32-c3 | EE:FF:..       | 离线 |[更][解]|
| - 字典                                                   | ...                                                              |
| - 参数管理                                              |----------------------------------------------------------------|
| - 配置中心                                              | 分页: [首页][上一页][1][2][3][下一页]  全选本页: [ ]          |
| - 管理员                                                |                                                                  |
| - 账号                                                  |                                                                  |
+----------------------+------------------------------------------------------------------+
```

### 设备注册 / 激活联调（设备工具）

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 设备注册 / 激活联调             |
| - 概览                                                   |----------------------------------------------------------------|
| - 设备工具 (当前)                                       | 激活请求头: [headers JSON] [发送] |
|   · 注册/激活联调 (当前)                                | 版本检查:   [headers+payload] [发] |
| - 其他                                                  |----------------------------------------------------------------|
|                                                          | 响应: { status:"ok", version:"1.2.3" } |
+----------------------+------------------------------------------------------------------+
```

### OTA 固件列表（含侧边栏）


```
+----------------------+--------------------------------------------------------------------------+
| 导航                                                     | OTA 固件                             |
| - 概览                                                   |----------------------------------------------------------------|
| - 智能体                                                | 名称:[_____][搜] 排序:[create_date][desc] [新增] [批量删]      |
| - 设备工具                                              |----------------------------------------------------------------|
| - OTA 固件 (当前)                                       | []全选 |#| 名称 | 类型 | 版本 | 大小 | 备注 | 操作               |
| - 模型                                                   | [ ]   |1| A   | s3  |1.2.3|2.3MB| 修复 |[编][删][下]        |
| - 音色管理                                              | [ ]   |2| B   | c3  |1.1.0|1.2MB| ...  |[编][删][下]        |
| - 字典                                                   |----------------------------------------------------------------|
| - 参数管理                                              | 分页: [«][1][2][3][»]                                         |
| - 配置中心                                              |                                                                  |
| - 管理员                                                |                                                                  |
| - 账号                                                  |                                                                  |
+----------------------+--------------------------------------------------------------------------+
```

#### 新增/编辑固件（弹窗）
- 对应 `useOtaDialog`：上传进度、类型校验、版本校验、必填校验。

```
+-------------------------------- 新增/编辑固件 -------------------------------+
| 名称: [____________________]   类型: [esp32-s3▼]   版本: [1.2.3]           |
| 备注: [______________________________]                                       |
| 文件: [ 选择文件 ]  (仅 .bin/.apk，≤100MB)                                   |
| 上传进度: [██████████------] 72%   状态: uploading/success/error             |
| [ 保存 ]  [ 取消 ]                                                            |
+-------------------------------------------------------------------------------+
```

### 模型列表（含侧边栏）
- 对应 `useModelList` + `useModelActions`：增改删、批量删、启用/禁用、默认、配置查看。

```
+----------------------+--------------------------------------------------------------------------+
| 导航                                                     | 模型管理                             |
| - 概览                                                   |----------------------------------------------------------------|
| - 智能体                                                | 类型:[TTS/LLM/ASR] 名称:[___][搜] [新增模型][批量删除]        |
| - 设备工具                                              |----------------------------------------------------------------|
| - OTA 固件                                              | []|#| 名称       |类型|状态|默认| 提供商 | 操作                |
| - 模型 (当前)                                           |[ ]|1| tts-fast  |TTS |启用| 否 | acme   |[编][禁用][默认][删] |
| - 音色管理                                              |[ ]|2| llm-xyz   |LLM |禁用| 是 | openai |[编][启用][取消][删]|
| - 字典                                                   |----------------------------------------------------------------|
| - 参数管理                                              | [查看配置] 弹窗/抽屼                                         |
| - 配置中心                                              |                                                                  |
| - 管理员                                                |                                                                  |
| - 账号                                                  |                                                                  |
+----------------------+--------------------------------------------------------------------------+
```

### 供应器（Provider）管理（含侧边栏）
- 对应 `useProviderPage`/`useProviderMutations`/`useProviderPluginNames`。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 供应器管理                     |
| - 概览                                                   |----------------------------------------------------------------|
| - 模型 (当前)                                           | 插件:[____] 状态:[全部] [查] [新增] [批量删]                    |
|   · 模型列表                                            |----------------------------------------------------------------|
|   · 供应器管理 (当前)                                   | []|#| 名称 | 插件 | 鉴权 | 备注 | 操作                        |
| - 其他                                                  |[ ]|1| acme | a    | **** | 基础 | [编辑][删除]               |
+----------------------+------------------------------------------------------------------+
```

### 音色（Timbre）管理（含侧边栏）
- 对应 `useTimbreList`/`useCreateTimbre`/`useUpdateTimbre`/`useDeleteTimbres`。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 音色管理                       |
| - 概览                                                   |----------------------------------------------------------------|
| - 模型                                                   | TTS 模型:[tts-fast] 关键词:[__][搜] [新增音色][批量删除]       |
| - 音色管理 (当前)                                       |----------------------------------------------------------------|
| - 字典                                                   | []|#| 名称     | 语言 | 采样率 | 备注   | 操作                  |
| - 参数管理                                              |[ ]|1| voice-a  | zh  | 22kHz  | 温暖   | [编辑][删除]          |
| - 配置中心                                              |----------------------------------------------------------------|
| - 管理员                                                | 分页: [«] [1] [2] [3] [»]                                       |
| - 账号                                                  |                                                                  |
+----------------------+------------------------------------------------------------------+
```

### 字典类型 / 字典数据（含侧边栏）
- 对应 `useDictTypes`/`useDictTypeActions` 与 `useDictData`/`useDictDataActions`。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 字典                           |
| - 概览                                                   |----------------------------------------------------------------|
| - 字典 (当前)                                           | 左：字典类型  右：字典数据（选中类型）                             |
|   · 字典类型 (当前)                                     |----------------------------------------------------------------|
|   · 字典数据                                            | [ 新增类型 ] [ 批量删除 ]   |  [ 新增数据 ] [ 批量删除 ]        |
| - 其他                                                  | []|#| 编码 | 名称 | 操作   |  []|#| 键 | 名称 | 排序 | 操作     |
|                                                         |[ ]|1| FW  | 固件 |[编][删]|  [ ]|1| s3 | S3  |  1  |[编][删]   |
+----------------------+------------------------------------------------------------------+
```

### 参数管理（含侧边栏）
- 对应 `useParamsManagement`：搜索、分页、全选、增改、批量删除。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 参数管理                       |
| - 概览                                                   |----------------------------------------------------------------|
| - 参数管理 (当前)                                       | 编码:[____][搜] 每页:[10▼] [新增参数] [删除选中]                |
| - 其他                                                  |----------------------------------------------------------------|
|                                                          | []|#| 编码        | 名称   | 值   | 操作                      |
|                                                          |[ ]|1| max_retries | 最大   |  3  | [编辑] [删除]             |
|                                                          | 分页: [«][1][2][3][»]  已选: 1/20                           |
+----------------------+------------------------------------------------------------------+
```

### 配置中心（含侧边栏）
- 对应 `useServerBaseConfig`/`useAgentModels`。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 配置中心                       |
| - 概览                                                   |----------------------------------------------------------------|
| - 配置中心 (当前)                                       | 服务端基础配置                 |
| - 其他                                                  |  - baseUrl: https://...        |
|                                                          |  - 上传限制: 100MB             |
|                                                          |--------------------------------|
|                                                          | 智能体模型能力                 |
|                                                          | AgentId:[____] [拉取模型能力]  |
|                                                          | 结果: { models:[...], ... }    |
+----------------------+------------------------------------------------------------------+
```

### 管理员视图：智能体列表（含侧边栏）
- 对应 `useAdminAgentList`。

```
+----------------------+------------------------------------------------------------------+
| 导航                                                     | 管理员 / 智能体列表             |
| - 概览                                                   |----------------------------------------------------------------|
| - 管理员 (当前)                                         | 搜索:[____][查询]                |
|   · 智能体列表 (当前)                                   |--------------------------------|
| - 其他                                                  | # | ID  | 名称  | 用户 | 设备 | 操作 |
|                                                          | 1 |1001 | 小智A | uA  |  6  |[详情]|
|                                                          | 2 |1002 | 小智B | uB  |  3  |[详情]|
+----------------------+------------------------------------------------------------------+
```

---

## 备注
- 所有列表均建议使用 `@tanstack/react-query` 结合 hooks 已有的 queryKey 做缓存与失效。
- 弹窗（新增/编辑）统一用抽屼或对话框样式，复用表单校验与提交态。
- 搜索与分页默认联动：搜索重置到第一页；变更 pageSize 重置到第一页。
- 设备与 OTA 等涉及批量操作的列表，默认提供全选本页与选中计数反馈。
